# 功能指南

完整的功能使用说明，帮助你充分利用扩展的各种功能。

## 📑 目录

- [中文反向查找](#中文反向查找)
- [强制查找模式](#强制查找模式)
- [快捷键使用](#快捷键使用)
- [日志查看](#日志查看)

---

## 中文反向查找

### 🎯 功能说明

悬停在**中文字符串**上时，扩展会自动反向查找该中文对应的翻译 key，并提供一键替换功能。

### ✨ 主要特性

- 🔍 智能识别纯中文字符串
- 🎯 模糊匹配，支持完全匹配和包含匹配
- 📋 显示多个匹配结果（默认 5 个，可配置）
- 🔄 点击 key 即可快速替换
- ⚡ 自动保持原有引号类型

### 📝 使用步骤

1. **确保在正常模式**（状态栏显示 `i18n 正常`）
2. **悬停在中文字符串上**
3. **查看匹配的 key 列表**
4. **点击要使用的 key**
5. **自动替换完成**

### 💡 使用示例

**重构前：**

```javascript
const message = "操作成功";
alert("网络连接失败");
```

**操作：**
1. 悬停在 `"操作成功"` 上
2. 看到建议：`MSG_SUCCESS`, `msg-success`, `100123` 等
3. 点击 `MSG_SUCCESS`

**重构后：**

```javascript
const message = "MSG_SUCCESS";  // 自动替换
alert("网络连接失败");
```

### ⚙️ 配置选项

```json
{
  // 控制显示的最大结果数量（1-20）
  "i18nHover.maxReverseResults": 5
}
```

**建议值：**
- **3-5**：快速查看（推荐）
- **6-10**：需要更多选择
- **11-20**：全面查看所有可能

---

## 强制查找模式

### 🎯 功能说明

切换到强制模式后，可以查看**任意字符串**的翻译，不限于函数调用中的字符串。

### 🎨 模式对比

| 特性 | 正常模式 | 强制模式 |
|-----|---------|---------|
| 状态栏 | `i18n 正常模式` | `i18n 强制模式`（黄色） |
| 识别范围 | 只在特定函数中 | 所有字符串 |
| 中文反向查找 | ✅ 启用 | ✅ 启用 |
| 适用场景 | 日常开发 | 全面检查 |

### 🚀 切换方法

**方法 1：快捷键（推荐）**
- 按 `Ctrl+Shift+H`（macOS: `Cmd+Shift+H`）

**方法 2：点击状态栏**
- 点击右下角的状态栏项

**方法 3：命令面板**
- `Ctrl+Shift+P` → "切换强制查找模式"

### 💡 使用场景

**场景 1：检查翻译覆盖率**

```javascript
// 正常模式下只检查函数中的 key
Language.GetContent("key1");  // ✅ 显示翻译
const str = "key2";           // ❌ 不显示

// 切换到强制模式（Ctrl+Shift+H）
Language.GetContent("key1");  // ✅ 显示翻译
const str = "key2";           // ✅ 也显示翻译
```

**场景 2：调试翻译问题**

1. 发现某个 key 显示不正确
2. 开启强制模式
3. 悬停查看实际翻译内容
4. 确认是否是翻译文件问题

### ⚠️ 使用建议

- ✅ 需要时开启，检查完关闭
- ❌ 避免长时间开启（会影响性能）
- 💡 正常开发保持正常模式

---

## 快捷键使用

### ⌨️ 默认快捷键

| 功能 | Windows/Linux | macOS |
|------|--------------|-------|
| 切换强制查找模式 | `Ctrl+Shift+H` | `Cmd+Shift+H` |

### 🔧 自定义快捷键

**方法 1：通过界面（推荐）**

1. 按 `Ctrl+K, Ctrl+S` 打开快捷键设置
2. 搜索 `toggleForceMode`
3. 双击修改

**方法 2：编辑配置文件**

按 `Ctrl+Shift+P`，输入 "Preferences: Open Keyboard Shortcuts (JSON)"：

```json
[
  {
    "key": "ctrl+alt+t",                    // 自定义快捷键
    "command": "i18nHover.toggleForceMode",
    "when": "editorTextFocus"
  }
]
```

### 💡 快捷键建议

**推荐的快捷键组合：**

| 快捷键 | 说明 | 特点 |
|--------|------|------|
| `Ctrl+Shift+H` | 默认 | H = Hover，易记 |
| `Ctrl+Alt+T` | 备选 | T = Translate |
| `Ctrl+Shift+I` | 备选 | I = i18n |
| `Alt+F` | 简短 | F = Force |

**避免使用：**
- ❌ `Ctrl+S/C/V/X/Z/Y` - 常用功能
- ❌ `Ctrl+F/H` - 查找替换
- ❌ `Ctrl+P` - 快速打开

### 🔍 when 条件

可以添加条件限制快捷键的触发时机：

```json
{
  "key": "ctrl+shift+h",
  "command": "i18nHover.toggleForceMode",
  // 只在 JavaScript 或 C# 文件中生效
  "when": "editorTextFocus && (editorLangId == 'javascript' || editorLangId == 'csharp')"
}
```

**常用条件：**
- `editorTextFocus` - 编辑器获得焦点
- `editorLangId == 'javascript'` - JavaScript 文件
- `!editorReadonly` - 非只读

---

## 日志查看

### 🔍 查看方法

**方法 1：输出面板（推荐 ⭐）**

1. 按 `Ctrl+Shift+U` 打开输出面板
2. 在右上角下拉菜单选择 `i18n Hover Translator`
3. 查看所有日志

**方法 2：命令快捷方式**

1. 按 `Ctrl+Shift+P` 打开命令面板
2. 输入 `i18n`
3. 选择 `显示日志输出`
4. 自动打开日志面板

**方法 3：开发者工具（调试用）**

1. 按 `Ctrl+Shift+I` 打开开发者工具
2. 切换到 `Console` 标签
3. 查看所有日志

### 📋 日志级别

```
[INFO]  - 一般信息（扩展启动、加载成功等）
[WARN]  - 警告信息（文件为空等非致命问题）
[ERROR] - 错误信息（加载失败、配置错误等）
[DEBUG] - 调试信息（详细运行信息）
```

### 🎯 常见日志

**成功启动：**

```
[INFO] i18n Hover Translator 已激活
[INFO] 使用默认路径: C:\Work\myproject\translations.txt
[INFO] 成功加载 150 条翻译
```

**加载失败：**

```
[ERROR] 翻译文件不存在: C:\Work\myproject\translations.txt
[ERROR] 翻译文件为空或无有效内容
```

### 🔧 调试技巧

**技巧 1：实时监控**
- 保持输出面板打开
- 实时查看日志输出
- 快速发现问题

**技巧 2：清空日志**
- 右键点击输出面板
- 选择 "Clear Output"
- 或按 `Ctrl+L`

**技巧 3：过滤日志**
- 在输出面板的搜索框中
- 输入关键词过滤
- 例如：`ERROR`、`翻译`、`加载`

### 💡 问题排查

**问题 1：看不到日志？**

检查：
1. ✅ 扩展是否已启用
2. ✅ 是否选择了正确的输出通道
3. ✅ 尝试重新加载窗口

**问题 2：日志太多？**

解决：
1. 使用搜索框过滤
2. 清空后重新触发功能
3. 只关注 `ERROR` 和 `WARN` 级别

**问题 3：日志显示乱码？**

解决：
1. 检查翻译文件编码（应为 UTF-8）
2. 重新加载扩展
3. 按 `Ctrl+Shift+P` → "Reload Window"

---

## 🎯 功能组合使用

### 组合 1：重构硬编码中文

1. **正常模式**：开发时保持正常模式
2. **遇到中文**：悬停查看匹配的 key
3. **快速替换**：点击合适的 key 完成替换
4. **强制检查**：按 `Ctrl+Shift+H` 开启强制模式，全面检查所有字符串

### 组合 2：翻译覆盖率检查

1. **开启强制模式**：`Ctrl+Shift+H`
2. **逐个检查**：悬停在所有字符串上
3. **查看日志**：`Ctrl+Shift+U` 查看是否有错误
4. **完成后关闭**：再按 `Ctrl+Shift+H` 关闭强制模式

### 组合 3：翻译文件更新

1. **修改翻译文件**：添加新的翻译条目
2. **重新加载**：`Ctrl+Shift+P` → "重新加载翻译文件"
3. **查看日志**：确认加载成功
4. **测试功能**：悬停验证新翻译是否生效

---

## 📚 相关文档

- [快速上手](./快速上手.md) - 5 分钟快速开始
- [配置指南](./配置指南.md) - 详细配置说明
- [README](../README.md) - 扩展概览

---

## ✅ 快速参考

| 操作 | 快捷键/命令 |
|-----|-----------|
| 切换强制模式 | `Ctrl+Shift+H` |
| 查看日志 | `Ctrl+Shift+U` |
| 重新加载翻译 | `Ctrl+Shift+P` → "重新加载翻译文件" |
| 打开设置 | `Ctrl+,` |
| 命令面板 | `Ctrl+Shift+P` |

---

**提示**：熟练使用这些功能，可以大大提高多语言开发效率！ 🚀

